{"version":3,"sources":["../../src/lib/utils.ts"],"names":["moment","require","getWorkDir","process","cwd","createIndexByNumber","num","s","Config","getPrefix","substr","length","getDigits","getMaxIndex","files","maxNumber","forEach","file","fileName","relativePath","indexNumber","substring","currentIndex","parseInt","getLatestIndex","getNewIndexString","lastIndex","generateFileName","originFileName","toLowerCase","trim","replace","getNumberLength","numberLength","split","getIndexByString","prefixLength","createDateString","format","Utils","getI18n"],"mappings":"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","sourcesContent":["import { getI18n } from './helpers/i18n'\nimport Config from './Config'\nimport { getFiles } from './file';\n\nlet moment = require('moment')\n\nfunction getWorkDir () {\n  return process.cwd()\n}\n\nfunction createIndexByNumber (num): string {\n  let s = '00000000' + num\n  return Config.getPrefix() + s.substr(s.length - Config.getDigits())\n}\n\nfunction getMaxIndex (files: {relativePath: string}[]) {\n  let maxNumber = 0\n  files.forEach(function (file) {\n    let fileName = file.relativePath\n    if (fileName === 'README.md') {\n      return\n    }\n\n    let indexNumber = fileName.substring(Config.getPrefix().length, Config.getDigits() + Config.getPrefix().length)\n    let currentIndex = parseInt(indexNumber, 10)\n    if (currentIndex > maxNumber) {\n      maxNumber = currentIndex\n    }\n  })\n\n  return maxNumber\n}\n\nfunction getLatestIndex (): number {\n  let files = getFiles()\n\n  if (!(files && files.length > 0)) {\n    return 0\n  }\n\n  return getMaxIndex(files)\n}\n\nfunction getNewIndexString (): string {\n  let lastIndex = getLatestIndex()\n  if (!lastIndex) {\n    return createIndexByNumber(1)\n  }\n  lastIndex = lastIndex + 1\n  return createIndexByNumber(lastIndex)\n}\n\nfunction generateFileName (originFileName) {\n  return originFileName.toLowerCase().trim()\n    .replace(/[\\s_-]+/g, '-') // swap any length of whitespace, underscore, hyphen characters with a single _\n    .replace(/^-+|-+$/g, '') // remove leading, trailing -\n    .replace(/，/g, '')\n    .replace(/。/g, '')\n    .replace(/ /g, '-')\n    .replace(/\\?/g, '-')\n    .replace(/#/g, '')\n    .replace(/:/g, '')\n    .replace(/# /g, '')\n}\n\nfunction getNumberLength (fileName: string): number {\n  let numberLength = fileName.split('-')[0]\n  return numberLength.length\n}\n\nfunction getIndexByString (fileName: string): number {\n  let numberLength = getNumberLength(fileName)\n  let prefixLength = Config.getPrefix().length\n  return parseInt(fileName.substring(prefixLength, numberLength + prefixLength), 10)\n}\n\nfunction createDateString (): string {\n  return moment().format('YYYY-MM-DD')\n}\n\nlet Utils = {\n  getNewIndexString: getNewIndexString,\n  getLatestIndex: getLatestIndex,\n  createIndexByNumber: createIndexByNumber,\n  generateFileName: generateFileName,\n  getWorkDir: getWorkDir,\n  getI18n: getI18n,\n  createDateString: createDateString,\n  getNumberLength: getNumberLength,\n  getIndexByString: getIndexByString\n}\n\nexport default Utils\n"],"file":"utils.js"}