{"version":3,"sources":["../../src/tests/logs.spec.ts"],"names":["sinon","require","fs","walkSync","LRU","mdTemplate","t","consoleSpy","stub","console","renameSpy","cacheSpy","prototype","returns","path","language","entriesSpy","relativePath","basePath","mode","size","mtime","fsReadSpy","onCall","logs","ADR","deepEqual","restore"],"mappings":";;;;AAKA;;AACA;;AANA,IAAIA,KAAK,GAAGC,OAAO,SAAnB;;AACA,IAAIC,EAAE,GAAGD,OAAO,MAAhB;;AACA,IAAIE,QAAQ,GAAGF,OAAO,aAAtB;;AACA,IAAIG,GAAG,GAAGH,OAAO,aAAjB;;AAKA,IAAII,UAAU,GAAI;;;;;;;;;;;;;CAAlB;AAeA,kBAAK,WAAL,EAAkBC,CAAC,IAAI;AACrB,MAAIC,UAAU,GAAGP,KAAK,CAACQ,IAAN,CAAWC,OAAX,EAAoB,KAApB,CAAjB;AACA,MAAIC,SAAS,GAAGV,KAAK,CAACQ,IAAN,CAAWN,EAAX,EAAe,YAAf,CAAhB;AACA,MAAIS,QAAQ,GAAGX,KAAK,CAACQ,IAAN,CAAWJ,GAAG,CAACQ,SAAf,EAA0B,KAA1B,EAAiCC,OAAjC,CAAyC;AACtDC,IAAAA,IAAI,EAAE,MADgD;AAEtDC,IAAAA,QAAQ,EAAE;AAF4C,GAAzC,CAAf;AAKA,MAAIC,UAAU,GAAGhB,KAAK,CAACQ,IAAN,CAAWL,QAAX,EAAqB,SAArB,EAAgCU,OAAhC,CAAwC,CACvD;AACEI,IAAAA,YAAY,EAAE,qBADhB;AAEEC,IAAAA,QAAQ,EAAE,sCAFZ;AAGEC,IAAAA,IAAI,EAAE,KAHR;AAIEC,IAAAA,IAAI,EAAE,GAJR;AAKEC,IAAAA,KAAK,EAAE;AALT,GADuD,EAQvD;AACEJ,IAAAA,YAAY,EAAE,WADhB;AAEEC,IAAAA,QAAQ,EAAE,sCAFZ;AAGEC,IAAAA,IAAI,EAAE,KAHR;AAIEC,IAAAA,IAAI,EAAE,GAJR;AAKEC,IAAAA,KAAK,EAAE;AALT,GARuD,CAAxC,CAAjB;AAgBA,MAAIC,SAAS,GAAGtB,KAAK,CAACQ,IAAN,CAAWN,EAAX,EAAe,cAAf,CAAhB;AACAoB,EAAAA,SAAS,CACNC,MADH,CACU,CADV,EACaV,OADb,CACqBR,UADrB,EAEGkB,MAFH,CAEU,CAFV,EAEaV,OAFb,CAEqBR,UAFrB;;AAIA,MAAImB,IAAI,GAAGC,aAAID,IAAJ,CAAS,GAAT,CAAX;;AACAlB,EAAAA,CAAC,CAACoB,SAAF,CAAYF,IAAZ,EAAmB;;;;;;;;;CAAnB;AAUAF,EAAAA,SAAS,CAACK,OAAV;AACAX,EAAAA,UAAU,CAACW,OAAX;AACApB,EAAAA,UAAU,CAACoB,OAAX;AACAjB,EAAAA,SAAS,CAACiB,OAAV;AACAhB,EAAAA,QAAQ,CAACgB,OAAT;AACD,CA7CD","sourcesContent":["let sinon = require('sinon')\nlet fs = require('fs')\nlet walkSync = require('walk-sync')\nlet LRU = require('lru-cache')\n\nimport test from 'ava'\nimport ADR from 'adr'\n\nlet mdTemplate = `# 1. 更友好的 CLI\n\n日期: 2017-11-23\n\n## 状态\n\n列表：提议/通过/完成/已弃用/已取代\n\n2017-11-23 提议\n\n2017-11-24 讨论\n\n2017-11-25 通过\n`\n\ntest('ADR: logs', t => {\n  let consoleSpy = sinon.stub(console, 'log')\n  let renameSpy = sinon.stub(fs, 'renameSync')\n  let cacheSpy = sinon.stub(LRU.prototype, 'get').returns({\n    path: 'some',\n    language: 'zh-cn'\n  })\n\n  let entriesSpy = sinon.stub(walkSync, 'entries').returns([\n    {\n      relativePath: '001-DAF编写完整的单元测试.md',\n      basePath: '/Users/fdhuang/learing/adr/docs/adr/',\n      mode: 33188,\n      size: 246,\n      mtime: 1511435254653\n    },\n    {\n      relativePath: 'README.md',\n      basePath: '/Users/fdhuang/learing/adr/docs/adr/',\n      mode: 33188,\n      size: 246,\n      mtime: 1511435254653\n    }\n  ])\n  let fsReadSpy = sinon.stub(fs, 'readFileSync')\n  fsReadSpy\n    .onCall(0).returns(mdTemplate)\n    .onCall(1).returns(mdTemplate)\n\n  let logs = ADR.logs('1')\n  t.deepEqual(logs, `╔════════════╤══════╗\n║  -         │  -   ║\n╟────────────┼──────╢\n║ 2017-11-23 │ 提议 ║\n╟────────────┼──────╢\n║ 2017-11-24 │ 讨论 ║\n╟────────────┼──────╢\n║ 2017-11-25 │ 通过 ║\n╚════════════╧══════╝\n`)\n  fsReadSpy.restore()\n  entriesSpy.restore()\n  consoleSpy.restore()\n  renameSpy.restore()\n  cacheSpy.restore()\n})\n"],"file":"logs.spec.js"}